<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.ssafy.enjoytrip.planDetail.model.mapper.PlanDetailMapper">

	<resultMap type="planDetailDto" id="PlanDetail">
		<result column="plan_id" property="planId"/> 
		<result column="detail_id" property="detailId"/>  
		<result column="name" property="name"/>
		<result column="address" property="address"/> 
		<result column="route" property="route"/>  
		<result column="lat" property="lat"/>
		<result column="lng" property="lng"/>
		<result column="photoUrl" property="photoUrl"/>
		<result column="price" property="price"/>
		<result column="memo" property="memo"/>
	</resultMap>
	
 	<select id="getRouteList" parameterType="String" resultMap="PlanDetail">
		select *
		from plan_detail
		where plan_id = #{planId}
		order by route asc;
	</select>
 
  	<select id="getPlanDetail" parameterType="String" resultMap="PlanDetail">
		select *
		from plan_detail
		where plan_id = #{planId} and address = #{address} and route is #{route};
	</select>
 
 
   	<select id="getPlanDetailById" parameterType="String" resultMap="PlanDetail">
		select *
		from plan_detail
		where detail_id = #{detailId};
	</select>
	
	<select id="listPlanDetail" parameterType="String" resultMap="PlanDetail">
		select *
		from plan_detail
		where plan_id = #{planId}
		order by route asc;
	</select>
	
	
	<insert id="writePlanDetail" parameterType="planDetailDto">
		insert into plan_detail (plan_id, name, address, route, lat, lng, photoUrl, price, memo)
		values (#{planId}, #{name}, #{address}, #{route}, #{lat}, #{lng}, #{photoUrl}, #{price}, #{memo})
	</insert>
 
	
	<update id="modifyPlanDetail" parameterType="planDetailDto">
		update plan_detail
		<trim prefix="set" suffixOverrides=",">
			<if test="route != null">route = #{route},</if> 
		</trim>
		where detail_id = #{detailId}
	</update>
	
	<delete id="deletePlanDetail" parameterType="String">
		delete from plan_detail
		where plan_id = #{planId};
	</delete>
</mapper>