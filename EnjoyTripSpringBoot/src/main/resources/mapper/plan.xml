<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="edu.ssafy.enjoytrip.plan.model.mapper.PlanMapper">

	<resultMap type="planDto" id="Plan">
		<result column="user_id" property="userId"/> 
		<result column="id" property="id"/> 
		<result column="name" property="name"/>  
		<result column="start_date" property="startDate"/> 
		<result column="end_date" property="endDate"/>  
		<result column="public" property="isPublic"/>  
	</resultMap>
	
	<insert id="writeArticle">
	insert into plan (user_id, name, start_date, end_date, public)
		values (#{userId}, #{name}, #{startDate}, #{endDate}, #{isPublic})
	</insert>
	
	
	<select id="listArticleMy" parameterType="String" resultMap="Plan">
		select user_id, id, name, 
		DATE_FORMAT(start_date, '%Y-%m-%d') as start_date,
		DATE_FORMAT(end_date, '%Y-%m-%d') as end_date, 
		public
		from plan 
		where user_id = #{userId}
		order by id desc;
	</select>
	
	<select id="listArticleAll" resultMap="Plan">
		select user_id, id, name, 
		DATE_FORMAT(start_date, '%Y-%m-%d') as start_date,
		DATE_FORMAT(end_date, '%Y-%m-%d') as end_date,
		public
		from plan
		where public=1
		order by id desc;
	</select>
	 
 	<select id="getArticle" parameterType="Integer" resultMap="Plan">
		select user_id, id, name, 
		DATE_FORMAT(start_date, '%Y-%m-%d') as start_date,
		DATE_FORMAT(end_date, '%Y-%m-%d') as end_date,
		public
		from plan 
		where id = #{id};
	</select>
	
	<update id="modifyArticle" parameterType="planDto">
		update plan 
		<trim prefix="set" suffixOverrides=",">
			<if test="name != null">name = #{name},</if> 
			<if test="startDate != null">start_date = #{startDate},</if> 
			<if test="endDate != null">end_date = #{endDate},</if> 
			<if test="isPublic != null">public = #{isPublic},</if> 
		</trim>
		where id = #{id}
	</update>
	
	<delete id="deleteArticle" parameterType="Integer">
		delete from plan 
		where id = #{id};
	</delete>
</mapper>